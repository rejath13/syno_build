(this["webpackJsonplocator-admin"]=this["webpackJsonplocator-admin"]||[]).push([[32],{1428:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(72),s=a.n(n);const c="http://85.195.96.47:3030/locator-admin/api/v1";t.b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n={"Content-Type":"application/json"};arguments.length>3&&void 0!==arguments[3]&&arguments[3]&&(n["Content-Type"]="multipart/form-data");var r="";if(a){var l=document.getElementById(a);l&&(r=l.textContent||l.innerText,l.innerHTML='<i class="fa fa-spinner fa-spin"> </i> Loading',l.disabled=!0)}return new Promise(((l,o)=>{s.a.post("".concat(c).concat(e),t,{headers:n}).then((function(e){try{if(200!==e.data.code)throw new Error(e.data.data);l(e.data.data)}catch(n){o(n.message)}finally{if(a){var t=document.getElementById(a);t&&(t.innerHTML=r,t.disabled=!1)}}})).catch((function(e){if(console.log("Error : ",e),o(e.message),a){var t=document.getElementById(a);if(!t)return;t.innerHTML=r,t.disabled=!1}}))}))}},1513:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a(0);var n=a(977),s=a.n(n),c=a(978),r=a.n(c);const l=e=>{r()(s.a).fire({icon:e.type,text:e.text})}},2068:function(e,t,a){},2515:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(1531),r=a(396),l=a(1437),o=a(1385),i=a(1336),d=a(2508),j=a(1988),m=a(1039),b=a(1316),h=(a(2067),a(2068),a(20)),p=a(1428),u=a(1513),x=a(71),O=a.n(x),g=a(2069),f=a.n(g),y=a(2070),C=a(1);var v=e=>Object(C.jsx)(y.CKEditor,{...e});var S=e=>Object(C.jsx)(s.a.Fragment,{children:Object(C.jsx)(v,{editor:f.a,data:e.html,onReady:t=>{if("document"===e.editor){document.querySelector(".document-editor__toolbar").appendChild(t.ui.view.toolbar.element),window.editor=t}},onChange:(t,a)=>{e.onChange&&e.onChange(a)},onBlur:e=>{},onFocus:e=>{}})});const N=e=>{let{name:t,file:a,onDelete:n}=e;return Object(C.jsxs)(c.a,{style:{width:"14rem",margin:10},children:[a&&Object(C.jsx)(c.a.Img,{height:100,width:100,variant:"top",src:a}),Object(C.jsxs)(c.a.Body,{style:{padding:5},children:[Object(C.jsx)(c.a.Text,{children:t}),Object(C.jsx)(r.a,{onClick:n,size:"sm",variant:"primary",children:"Remove"})]})]})};function w(e){let{columns:t,data:a,fromNumber:n,toNumber:s,totalCount:c}=e;const{getTableProps:r,getTableBodyProps:d,headerGroups:j,prepareRow:h,page:p,canPreviousPage:u,canNextPage:x,pageOptions:O,pageCount:g,gotoPage:f,nextPage:y,previousPage:v,state:{sortBy:S,pageIndex:N}}=Object(b.useTable)({columns:t,data:a,manualSortBy:!0,initialState:{pageIndex:0},pageCount:Math.ceil(c/10)},b.useSortBy,b.usePagination);return Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(m.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,...r(),children:[Object(C.jsx)("thead",{children:j.map((e=>Object(C.jsx)("tr",{...e.getHeaderGroupProps(),children:e.headers.map((e=>Object(C.jsxs)("th",{style:{whiteSpace:"normal"},className:e.className,...e.getHeaderProps(e.getSortByToggleProps()),children:[e.render("Header"),Object(C.jsx)("span",{children:e.isSorted?e.isSortedDesc?Object(C.jsx)("span",{className:"feather icon-arrow-down text-muted float-right mt-1"}):Object(C.jsx)("span",{className:"feather icon-arrow-up text-muted float-right mt-1"}):""})]})))})))}),Object(C.jsx)("tbody",{...d(),children:p.map(((e,t)=>(h(e),Object(C.jsx)("tr",{...e.getRowProps(),children:e.cells.map((e=>Object(C.jsx)("td",{...e.getCellProps({className:e.column.className}),children:e.render("Cell")})))}))))})]}),Object(C.jsxs)(l.a,{className:"justify-content-between mt-3",children:[Object(C.jsx)(o.a,{sm:12,md:4,children:Object(C.jsxs)("span",{className:"d-flex align-items-center",children:["Page"," ",Object(C.jsxs)("strong",{children:[" ",N+1," of ",O.length," "]})," ","| Go to page:"," ",Object(C.jsx)("input",{type:"number",className:"form-control ml-2",value:N+1,onChange:e=>{const t=e.target.value?Number(e.target.value)-1:0;f(t)},style:{width:"100px"}})]})}),Object(C.jsx)(o.a,{sm:12,md:4,children:Object(C.jsxs)("span",{children:[n," - ",s," of ",c," items"]})}),Object(C.jsx)(o.a,{sm:12,md:4,children:Object(C.jsxs)(i.a,{className:"justify-content-end",children:[Object(C.jsx)(i.a.First,{onClick:()=>f(0),disabled:!u}),Object(C.jsx)(i.a.Prev,{onClick:()=>v(),disabled:!u}),Object(C.jsx)(i.a.Next,{onClick:()=>y(),disabled:!x}),Object(C.jsx)(i.a.Last,{onClick:()=>f(g-1),disabled:!x})]})})]})]})}t.default=()=>{const e=localStorage.getItem("authToken"),[t,a]=Object(n.useState)(!1),[i,m]=Object(n.useState)(""),[b,x]=Object(n.useState)([]),[g,f]=Object(n.useState)(""),[y,v]=Object(n.useState)([]),[B,P]=Object(n.useState)(!1),[T,H]=Object(n.useState)([]),[L,F]=Object(n.useState)([]),_=Object(n.useRef)(),k=e=>{const t=[...T];t.splice(e,1);const a=[...L];a.splice(e,1),H(t),F(a)},M=()=>a(!t);Object(n.useEffect)((()=>{0!==b.length&&f(b[0].technician_id)}),[b]);Object(n.useEffect)((()=>{(async()=>{const t={method:"get",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Xtoken:e}},a=h.a+"technicians",n=await fetch(a,t),s=await n.json();x(s.data)})(),(async()=>{try{P(!0);const e=await Object(p.b)("/sales/sandbox");v(e)}catch(e){Object(u.a)({title:"Oops!",type:"error",text:e})}finally{P(!1)}})()}),[]);const A=s.a.useMemo((()=>[{Header:"Date",accessor:"createdAt",disableSortBy:!1,Cell:e=>{let{row:t}=e;return Object(C.jsx)("span",{children:O()(t.original.createdAt).format("LLL")})}},{Header:"Sales Person",accessor:"mailFrom",disableSortBy:!0},{Header:"To Address",accessor:"mailTo",disableSortBy:!0},{Header:"Subject",accessor:"mailSubject",disableSortBy:!0},{Header:"No. of Attachments",accessor:"mailAttachments",disableSortBy:!0,Cell:e=>{let{row:t}=e;try{var a=JSON.parse(t.original.mailAttachments);return Object(C.jsxs)("span",{className:"badge badge-primary",children:[" ",a.length," "]})}catch(n){return console.log(n),Object(C.jsx)("span",{className:"badge badge-primary",children:" 0"})}}}]));return Object(C.jsxs)(s.a.Fragment,{children:[Object(C.jsxs)(d.a,{show:t,onHide:M,backdrop:"static",size:"lg",className:"mail-modal",children:[Object(C.jsx)(d.a.Header,{closeButton:!0,children:Object(C.jsx)(d.a.Title,{as:"h5",children:"Compose Mail"})}),Object(C.jsxs)("form",{ref:_,onSubmit:e=>(async e=>{e.preventDefault();const t=new FormData(e.target);console.log(g,b);const n=b.find((e=>e.technician_id==g));console.log("from",n),t.append("from",n.technician_email),t.append("body",i.toString("html")),T.map((e=>{t.append("attachments",e)}));try{const e=await Object(p.b)("/sales/send-mail",t,"sendMailButton",!0);Object(u.a)({title:"Mail Sent!",type:"success",text:"Mail has been sent to ".concat(e.mailTo)}),_.current.reset()}catch(s){console.log("Error",s),Object(u.a)({title:"Oops!",type:"error",text:s})}finally{a(!1)}})(e),children:[Object(C.jsx)(d.a.Body,{children:Object(C.jsxs)(l.a,{children:[Object(C.jsx)(o.a,{md:"12",children:Object(C.jsx)(j.a.Group,{children:Object(C.jsx)(j.a.Control,{controlId:"sales_person_id",onChange:e=>f(e.target.value),as:"select",defaultValue:g,name:"sales_person_id",children:b&&b.map((e=>Object(C.jsx)("option",{value:e.technician_id,children:e.technician_name},e.technician_id)))})})}),Object(C.jsx)(o.a,{md:"12",children:Object(C.jsx)(j.a.Group,{children:Object(C.jsx)(j.a.Control,{type:"email",name:"to",placeholder:"To Address"})})}),Object(C.jsx)(o.a,{md:"12",children:Object(C.jsx)(j.a.Group,{children:Object(C.jsx)(j.a.Control,{type:"text",name:"subject",placeholder:"Subject"})})}),Object(C.jsx)(o.a,{md:"12",children:Object(C.jsxs)(j.a.Group,{children:[Object(C.jsx)(j.a.Label,{children:"Body"}),Object(C.jsx)(S,{html:i,onChange:e=>{const t=e.getData();m(t)}})]})}),Object(C.jsxs)(o.a,{md:"12",children:[Object(C.jsxs)(j.a.Group,{children:[Object(C.jsx)(j.a.Label,{children:"Attachments"}),Object(C.jsxs)("div",{className:"custom-file",children:[Object(C.jsx)(j.a.Control,{multiple:!0,onChange:e=>{const t=Array.from(e.target.files),a=t.map((e=>({file:e,url:e.type.includes("image")?URL.createObjectURL(e):null})));H([...T,...t]),F([...L,...a])},type:"file",className:"custom-file-input",id:"validatedCustomFile"}),Object(C.jsx)(j.a.Label,{className:"custom-file-label",htmlFor:"validatedCustomFile",children:"Choose file..."})]})]}),L.length>0&&Object(C.jsx)("div",{className:"d-flex p-2",children:L.map(((e,t)=>Object(C.jsxs)(s.a.Fragment,{children:[e.url&&Object(C.jsx)(N,{name:e.file.name,file:e.url,onDelete:()=>k(t)}),!e.url&&Object(C.jsx)(N,{name:e.file.name,file:!1,onDelete:()=>k(t)})]},e.file.name)))})]})]})}),Object(C.jsx)(d.a.Footer,{children:Object(C.jsx)(r.a,{variant:"primary",id:"sendMailButton",type:"submit",children:"Send Mail"})})]})]}),Object(C.jsxs)(l.a,{children:[Object(C.jsx)(o.a,{className:"text-end",md:"12",children:Object(C.jsxs)("button",{className:"text-capitalize btn btn-primary",type:"button",onClick:M,style:{marginRight:"3px",padding:"10px 15px",float:"right"},children:[Object(C.jsx)("i",{className:"fas fa-plus",style:{margin:0,fontSize:"16px"}})," ","Compose"]})}),Object(C.jsx)(o.a,{children:Object(C.jsx)(c.a,{children:Object(C.jsx)(c.a.Body,{style:{padding:"15px"},children:Object(C.jsx)(w,{columns:A,data:y,fromNumber:1,toNumber:10,totalCount:y.length})})})})]})]})}}}]);