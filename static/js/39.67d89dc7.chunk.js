(this["webpackJsonplocator-admin"]=this["webpackJsonplocator-admin"]||[]).push([[39],{2456:function(e,t,a){},2501:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a.n(c),i=a(1988),l=a(1385),n=a(760),r=a(756),o=a(1685),d=a(396),j=a(1437),h=a(1336),m=a(1531),b=a(977),u=a.n(b),x=a(978),p=a.n(x),O=a(1039),g=a(1316),v=(a(2456),a(20)),f=a(72),_=a.n(f),y=a(1430),C=a(2457),N=a.n(C),S=a(1);const k=e=>{p()(u.a).fire({icon:"success",text:e.text,type:e.type})};function w(e){let{columns:t,data:a,fromNumber:s,toNumber:b,getVehiclesList:u,totalCount:x}=e;const{getTableProps:p,getTableBodyProps:f,headerGroups:C,prepareRow:w,page:I,canPreviousPage:E,canNextPage:P,pageOptions:T,pageCount:A,gotoPage:B,nextPage:D,previousPage:H,state:{sortBy:L,pageIndex:M}}=Object(g.useTable)({columns:t,data:a,disableSortRemove:!0,manualSortBy:!0,initialState:{pageIndex:0,sortBy:[{id:"",desc:!0}]},manualPagination:!0,pageCount:Math.ceil(x/50)},g.useSortBy,g.usePagination),[F,z]=Object(c.useState)(null),[R,V]=Object(c.useState)(!1),G=localStorage.getItem("loginUserId"),[X,J]=Object(c.useState)(),K=localStorage.getItem("authToken"),[U,W]=Object(c.useState)(!1),[q,Q]=Object(c.useState)([]),[Y,Z]=Object(c.useState)(!1),[$,ee]=Object(c.useState)(!1),[te,ae]=Object(c.useState)("no"),[ce,se]=Object(c.useState)("active"),[ie,le]=Object(c.useState)(null),ne=async e=>{ee(!0);try{const t={method:"get",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Xtoken:K}},a=v.a+"searchfromEtisalatList/"+e,c=await fetch(a,t),s=await c.json();"success"===s.status?(Q(s.data),!1===Y&&Z(!0),ee(!1)):(y.a.error({title:"Error ",text:s.data}),ee(!1))}catch{}},re=()=>{U?(le(F),ne(F)):M>0?B(0):V(!R)};Object(c.useEffect)((()=>{u(M,F,L,te,ce)}),[L,M,R]);const oe=()=>Object(S.jsx)("div",{className:"divLoader",children:Object(S.jsx)("svg",{className:"svgLoader",viewBox:"0 0 100 100",width:"10em",height:"10em",children:Object(S.jsx)("path",{stroke:"none",d:"M10 50A40 40 0 0 0 90 50A40 42 0 0 1 10 50",fill:"#51CACC",transform:"rotate(179.719 50 51)",children:Object(S.jsx)("animateTransform",{attributeName:"transform",type:"rotate",calcMode:"linear",values:"0 50 51;360 50 51",keyTimes:"0;1",dur:"1s",begin:"0s",repeatCount:"indefinite"})})})});return Object(S.jsxs)(S.Fragment,{children:[$?Object(S.jsx)(oe,{}):null,Object(S.jsx)(i.a,{children:Object(S.jsxs)(i.a.Row,{children:[Object(S.jsx)(l.a,{xs:1,style:{color:"black"},children:Object(S.jsx)("span",{style:{top:"12px",position:"relative"},children:Object(S.jsxs)("b",{children:["Total : ",x]})})}),Object(S.jsx)(l.a,{xs:1,children:Object(S.jsxs)(i.a.Control,{as:"select",value:ce,onChange:e=>{se(e.target.value),V(!0!==R)},children:[Object(S.jsx)("option",{value:"all",children:"All"}),Object(S.jsx)("option",{value:"active",children:"Active"}),Object(S.jsx)("option",{value:"offline",children:"Offline"}),Object(S.jsx)("option",{value:"blocked",children:"Blocked"}),Object(S.jsx)("option",{value:"deviceblocked",children:"Devices Blocked"}),Object(S.jsx)("option",{value:"duplicates",children:"Duplicates"})]})}),Object(S.jsx)(l.a,{xs:"2",children:Object(S.jsxs)(i.a.Control,{as:"select",value:te,onChange:e=>{ae(e.target.value),V(!0!==R)},children:[Object(S.jsx)("option",{value:"no",children:"Not Verified"}),Object(S.jsx)("option",{value:"yes",children:"Verified"}),Object(S.jsx)("option",{value:"all",children:"All"})]})}),Object(S.jsxs)(l.a,{xs:3,children:[Object(S.jsx)(i.a.Control,{placeholder:"Search...",value:F||"",onChange:e=>{z(e.target.value)},onKeyPress:e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),re())}}),F&&Object(S.jsx)("button",{type:"button",class:"react-datepicker__close-icon",onClick:()=>{z(null),W(!1),M>0?B(0):V(!0!==R)},style:{right:"2px",height:"90%"}})]}),Object(S.jsxs)(l.a,{xs:2,children:[Object(S.jsx)(n.a,{placement:"top",overlay:Object(S.jsx)(r.a,{id:"tooltip-top",children:"Search from IMEI in Etisalat Portal"}),children:Object(S.jsxs)("div",{className:"checkbox d-inline checkbox-primary",children:[Object(S.jsx)(i.a.Control,{type:"checkbox",name:"etisalat_search",checked:U,id:"etisalat_search",onChange:e=>W(e.target.checked)}),Object(S.jsx)(i.a.Label,{htmlFor:"etisalat_search",className:"cr"})]})}),Object(S.jsx)("button",{className:"text-capitalize btn btn-success",type:"button",onClick:re,children:Object(S.jsx)("i",{className:"feather icon-search",style:{margin:0,fontSize:"16px"}})}),Object(S.jsx)("button",{className:"text-capitalize btn btn-danger",type:"button",onClick:()=>{z(null),W(!1),M>0?B(0):V(!R)},children:Object(S.jsx)("i",{className:"feather icon-refresh-cw",style:{margin:0}})})]}),Object(S.jsx)(l.a,{xs:3,children:"1"===G?Object(S.jsxs)(o.a,{className:"mb-3 cust-file-button",children:[Object(S.jsxs)("div",{className:"custom-file",children:[Object(S.jsx)(i.a.Control,{"aria-describedby":"custom-addons8",type:"file",className:"custom-file-input",id:"validatedCustomFile4",onChange:e=>J(e.target.files[0])}),Object(S.jsx)(i.a.Label,{className:"custom-file-label",htmlFor:"validatedCustomFile4",children:"Choose file"})]}),Object(S.jsx)(o.a.Append,{children:Object(S.jsx)(d.a,{id:"custom-addons8",onClick:()=>(()=>{ee(!0);const e=new FormData;e.append("file",X);const t=v.a+"importEtisalatCsv";_.a.post(t,e,{headers:{"Content-Type":"multipart/form-data",Xtoken:K}}).then((e=>{if("success"==e.data.status){let t="";e.data.data>0&&0===e.data.errorcount?t="".concat(e.data.data," rows uploaded successfully."):e.data.data>0&&e.data.errorcount>0?t="".concat(e.data.data," rows uploaded successfully. ").concat(e.data.errorcount," rows failed"):0===e.data.data&&e.data.errorcount>0?t="".concat(e.data.errorcount," rows failed"):0===e.data.data&&0===e.data.errorcount&&(t="No rows uploaded"),ee(!1),k({title:"Success!",type:"success",text:t}),J("")}else ee(!1),k({title:"Error",type:"error",text:e.data.data})})).catch((e=>{ee(!1),y.a.error({title:"Error",text:e.data.message})}))})(),style:{lineHeight:"1.6"},children:"Button"})})]}):""})]})}),Object(S.jsxs)(O.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,...p(),children:[Object(S.jsx)("thead",{children:C.map((e=>Object(S.jsx)("tr",{...e.getHeaderGroupProps(),children:e.headers.map((e=>Object(S.jsxs)("th",{style:{whiteSpace:"normal"},className:e.className,...e.getHeaderProps(e.getSortByToggleProps()),children:[e.render("Header"),Object(S.jsx)("span",{children:e.isSorted?e.isSortedDesc?Object(S.jsx)("span",{className:"feather icon-arrow-down text-muted float-right mt-1"}):Object(S.jsx)("span",{className:"feather icon-arrow-up text-muted float-right mt-1"}):""})]})))})))}),Object(S.jsx)("tbody",{...f(),children:I.map(((e,t)=>(w(e),Object(S.jsx)("tr",{...e.getRowProps(),children:e.cells.map((e=>Object(S.jsx)("td",{...e.getCellProps({className:e.column.className}),children:e.render("Cell")})))}))))})]}),Object(S.jsxs)(j.a,{className:"justify-content-between mt-3",children:[Object(S.jsx)(l.a,{sm:12,md:4,children:Object(S.jsxs)("span",{className:"d-flex align-items-center",children:["Page "," "," ",Object(S.jsxs)("strong",{children:[" ",M+1," of ",T.length," "]})," ","| Go to page:"," ",Object(S.jsx)("input",{type:"number",className:"form-control ml-2",value:M+1,onChange:e=>{const t=e.target.value?Number(e.target.value)-1:0;B(t)},style:{width:"100px"}})]})}),Object(S.jsx)(l.a,{sm:12,md:4,children:Object(S.jsxs)("span",{children:[s," - ",b," of ",x," items"]})}),Object(S.jsx)(l.a,{sm:12,md:4,children:Object(S.jsxs)(h.a,{className:"justify-content-end",children:[Object(S.jsx)(h.a.First,{onClick:()=>B(0),disabled:!E}),Object(S.jsx)(h.a.Prev,{onClick:()=>H(),disabled:!E}),Object(S.jsx)(h.a.Next,{onClick:()=>D(),disabled:!P}),Object(S.jsx)(h.a.Last,{onClick:()=>B(A-1),disabled:!P})]})})]}),Object(S.jsxs)(N.a,{initWidth:800,onRequestClose:()=>Z(!1),isOpen:Y,children:[Object(S.jsx)("h5",{children:"Search Result from IMEI in Etisalat Portal"}),Object(S.jsx)("div",{className:"body",children:Object(S.jsx)(j.a,{style:{margin:"0 auto",width:"100%"},children:Object(S.jsx)(l.a,{md:12,className:"p-0",children:Object(S.jsx)(m.a,{style:{margin:0},children:Object(S.jsxs)(m.a.Body,{style:{maxHeight:"75vh"},children:[Object(S.jsx)(i.a,{children:Object(S.jsxs)(i.a.Row,{children:[Object(S.jsx)(l.a,{xs:6}),Object(S.jsxs)(l.a,{xs:4,children:[Object(S.jsx)(i.a.Control,{placeholder:"Search...",value:ie||"",onChange:e=>{le(e.target.value),z(ie)},onKeyPress:e=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),z(ie),ne(ie))}}),null!==ie&&ie.length>0?Object(S.jsxs)("span",{children:["Number of digits: ",ie.length]}):""]}),Object(S.jsx)(l.a,{xs:1,children:Object(S.jsx)("button",{className:"text-capitalize btn btn-success",type:"button",onClick:()=>{ne(ie)},children:Object(S.jsx)("i",{className:"feather icon-search",style:{margin:0,fontSize:"16px"}})})})]})}),Object(S.jsxs)("table",{className:"etisalat-table table-bordered",children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{children:"IMEI"}),Object(S.jsx)("th",{children:"ICCID"}),Object(S.jsx)("th",{children:"Sim"})]})}),Object(S.jsx)("tbody",{children:q&&q.map(((e,t)=>Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:e.imei}),Object(S.jsx)("td",{children:e.iccid}),Object(S.jsx)("td",{children:e.sim})]})))})]}),Object(S.jsx)("button",{className:"mt-2 btn btn-secondary float-right",onClick:()=>Z(!1),children:"Close"})]})})})})})]})]})}t.default=function(){const e=localStorage.getItem("authToken"),[t,a]=Object(c.useState)([]),[o,d]=Object(c.useState)(null),[h,b]=Object(c.useState)(0),[u,x]=Object(c.useState)(0),[p,O]=Object(c.useState)(!1),[g,f]=Object(c.useState)(1),[_,C]=Object(c.useState)(""),[N,k]=Object(c.useState)(""),[I,E]=Object(c.useState)(""),[P,T]=Object(c.useState)(!1),[A,B]=Object(c.useState)(""),[D,H]=Object(c.useState)("desc"),[L,M]=Object(c.useState)(0),[F,z]=Object(c.useState)(!1),R=s.a.useMemo((()=>[{Header:"Customer Name/UserName",accessor:"customer_name",className:"namecolumn",Cell:e=>{let{row:t}=e;return Object(S.jsxs)("span",{className:"pointer",children:[t.original.customer_name," ",Object(S.jsx)("br",{}),Object(S.jsxs)("span",{children:[Object(S.jsx)(n.a,{placement:"top",overlay:Object(S.jsx)(r.a,{id:"tooltip-top",children:"Username"}),children:Object(S.jsxs)("span",{children:["(",t.original.customer_username,") "]})}),Object(S.jsx)(n.a,{placement:"top",overlay:Object(S.jsx)(r.a,{id:"tooltip-top",children:"Customer Status"}),children:Object(S.jsx)("span",{className:"blocked"===t.original.customer_status?"text-danger mr-2":"text-success mx-2",style:{"text-transform":"capitalize"},children:"followup"===t.original.customer_status?"Newly Created":t.original.customer_status})}),Object(S.jsx)(n.a,{placement:"top",overlay:Object(S.jsx)(r.a,{id:"tooltip-top",children:"Implementation Type"}),children:Object(S.jsx)("span",{className:"text-primary",children:t.original.customer_implementation_type})})]})]})}},{Header:"Vehicle Name/IMEI",accessor:"vehicle_name",className:"vehiclecolumn",Cell:e=>{let{row:t}=e;return Object(S.jsxs)("span",{children:[t.original.vehicle_name,Object(S.jsx)("br",{}),Object(S.jsx)(n.a,{placement:"top",overlay:Object(S.jsx)(r.a,{id:"tooltip-top",children:"IMEI"}),children:Object(S.jsx)("span",{children:t.original.vehicle_imei})})]})}},{Header:"NW",accessor:"vehicle_sim_4g",className:"networkclmn",Cell:e=>{let{row:t}=e;return Object(S.jsx)("span",{className:"pointer",children:Object(S.jsxs)(i.a.Control,{as:"select",name:"network",onChange:e=>U(e,t.original.vehicle_id),value:t.original.vehicle_sim_4g,children:[Object(S.jsx)("option",{value:"yes",children:"4G"}),Object(S.jsx)("option",{value:"no",children:"2G"})]})})}},{Header:"ICCID",accessor:"vehicle_iccid",className:"iccidcolumn",Cell:e=>{let{row:t}=e;return Object(S.jsxs)("span",{className:"pointer d-flex",children:[Object(S.jsx)(i.a.Control,{name:"iccid",id:"iccid_".concat(t.original.vehicle_id),value:t.original.vehicle_iccid,onChange:e=>{t.original.vehicle_iccid=e.target.value,G(t.original.vehicle_traccar_id,e)},onKeyPress:e=>V(e,t.original.vehicle_traccar_id,t.original.vehicle_iccid)}),Object(S.jsx)("button",{className:"btn btn-success text-capitalize my-0 mx-1 p-2",onClick:()=>K(t.original.vehicle_traccar_id,t.original.vehicle_iccid),children:Object(S.jsx)("i",{className:"feather icon-search m-0"})})]})}},{Header:"Sim",accessor:"vehicle_sim",className:"imeicolumn",Cell:e=>{let{row:t}=e;return Object(S.jsx)("span",{className:"pointer",children:Object(S.jsx)(i.a.Control,{name:"sim",className:" mr-1",id:"sim_".concat(t.original.vehicle_id),value:t.original.vehicle_sim,onChange:e=>X(t.original.vehicle_traccar_id,e)})})}},{Header:"Comment",accessor:"vehicle_sim_management_note",className:"commentcolumn",Cell:e=>{let{row:t}=e;return Object(S.jsx)("span",{className:"pointer",children:Object(S.jsx)(i.a.Control,{name:"sim_note",className:"mr-1",value:t.original.vehicle_sim_management_note||"",onChange:e=>J(t.original.vehicle_id,e)})})}},{Header:"Verified",accessor:"vehicle_sim_verified",className:"buttoncolumn",Cell:e=>{let{row:t}=e;return Object(S.jsxs)("div",{className:"checkbox d-inline checkbox-primary",children:[Object(S.jsx)(i.a.Control,{type:"checkbox",name:"verified_sim_".concat(t.original.vehicle_id),checked:"yes"===t.original.vehicle_sim_verified,id:"verified_sim_".concat(t.original.vehicle_id),onClick:e=>W(e,t.original.vehicle_id)}),Object(S.jsx)(i.a.Label,{htmlFor:"verified_sim_".concat(t.original.vehicle_id),className:"cr"})]})}},{Header:"",accessor:"action",className:"buttoncolumn",disableSortBy:!0,Cell:e=>{let{row:t}=e;return Object(S.jsx)("span",{children:Object(S.jsx)(n.a,{placement:"top",overlay:Object(S.jsx)(r.a,{id:"tooltip-top",children:"Save"}),children:Object(S.jsx)("button",{className:"btn btn-primary text-capitalize p-2",onClick:()=>{const e=t.values;console.log(e),q(t.original.vehicle_traccar_id,t.original.vehicle_iccid,t.original.vehicle_sim,t.original.vehicle_sim_verified,t.original.vehicle_sim_4g,t.original.vehicle_sim_management_note)},children:Object(S.jsx)("i",{className:"far fa-save m-0"})})})})}}]),[]),V=(e,t,a)=>{"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),K(t,a))},G=(e,t)=>{t.preventDefault();let c="";a((a=>{const s=a.findIndex((t=>t.vehicle_traccar_id===e));if(s>=0)return c=a[s],a[s]={...a[s],vehicle_iccid:t.target.value},[...a]}))},X=(e,t)=>{t.preventDefault();let c="";a((a=>{const s=a.findIndex((t=>t.vehicle_traccar_id===e));if(s>=0)return c=a[s],a[s]={...a[s],vehicle_sim:t.target.value},[...a]}))},J=(e,t)=>{t.preventDefault();let c="";a((a=>{const s=a.findIndex((t=>t.vehicle_id===e));if(s>=0)return c=a[s],a[s]={...a[s],vehicle_sim_management_note:t.target.value},[...a]}))},K=async(t,c)=>{M(t),O(!0);try{const s={method:"get",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Xtoken:e}},i=v.a+"getSimNumberfromEtisalat/"+c,l=await fetch(i,s),n=await l.json();if("success"===n.status){let e="";a((a=>{const c=a.findIndex((e=>e.vehicle_traccar_id===t));if(c>=0)return e=a[c],a[c]={...a[c],vehicle_sim:n.data.sim},[...a]})),z(!F)}else y.a.error({title:"Error ",text:n.data});O(!1)}catch{}},U=(e,t)=>{let c="";a((a=>{const s=a.findIndex((e=>e.vehicle_id===t));if(s>=0)return c=a[s],a[s]={...a[s],vehicle_sim_4g:e.target.value},[...a]}))},W=async(e,t)=>{var c=e.target.checked;c=1==c?"yes":"no";let s="";a((e=>{const a=e.findIndex((e=>e.vehicle_id===t));if(a>=0)return s=e[a],e[a]={...e[a],vehicle_sim_verified:c},[...e]}))},q=async(t,a,c,s,i,l)=>{const n={vehicle_traccar_id:t,vehicle_iccid:a,vehicle_sim:c,vehicle_sim_verified:s,vehicle_sim_4g:i,vehicle_sim_management_note:l};O(!0);try{const a={method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Xtoken:e},body:JSON.stringify(n)},c=v.a+"updateSimDetails/"+t,s=await fetch(c,a),i=await s.json();"success"===i.status?(T(!0!==P),y.a.success({title:"Success",text:i.data})):y.a.error({title:"Error ",text:i.data}),O(!1)}catch{}};Object(c.useEffect)((()=>{const e=[{id:A,desc:"desc"===D}];console.log(_);Q(g,_,e,N,I)}),[P]);const Q=Object(c.useCallback)((async(t,c,s,i,l)=>{O(!0),d(0);const n=t+1;f(t);var r="",o="";C(c),k(i),E(l),s.length>0&&(B(s[0].id),r=s[0].id,s[0].desc?(H("desc"),o="desc"):(H("asc"),o="asc"));const j={keyword:c,sortType:r||A,sortOrder:o||D,export:!1,verificationStatus:i,status:l};try{const t={method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json",Xtoken:e},body:JSON.stringify(j)},c=v.a+"simList?page="+n,s=await fetch(c,t),i=await s.json();a(i.data.data),d(i.data.total),b(i.data.from),x(i.data.to),O(!1),T(!1)}catch{}}),[]),Y=()=>Object(S.jsx)("div",{className:"divLoader",children:Object(S.jsx)("svg",{className:"svgLoader",viewBox:"0 0 100 100",width:"10em",height:"10em",children:Object(S.jsx)("path",{stroke:"none",d:"M10 50A40 40 0 0 0 90 50A40 42 0 0 1 10 50",fill:"#51CACC",transform:"rotate(179.719 50 51)",children:Object(S.jsx)("animateTransform",{attributeName:"transform",type:"rotate",calcMode:"linear",values:"0 50 51;360 50 51",keyTimes:"0;1",dur:"1s",begin:"0s",repeatCount:"indefinite"})})})});return Object(S.jsx)(s.a.Fragment,{children:Object(S.jsx)(j.a,{children:Object(S.jsxs)(l.a,{className:"p-0",children:[p?Object(S.jsx)(Y,{}):null,Object(S.jsx)(m.a,{children:Object(S.jsx)(m.a.Body,{style:{padding:"15px"},children:Object(S.jsx)(w,{columns:R,data:t,fromNumber:h,toNumber:u,getVehiclesList:Q,totalCount:o})})})]})})})}}}]);